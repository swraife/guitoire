.activity__top
  .activity__top-left
    .activity__avatar.inl-block
      = image_tag(activity.owner.avatar.url(:thumb))
  .activity__top-right
    .activity__subject
      = link_to activity.owner.public_name, activity.owner
      - if activities.count > 1
        = "added #{activities.count} new #{'resource'.pluralize(activities.count)} to"
        = link_to activity.recipient.name, activity.recipient
      - else
        = 'added a new'
        = activity.trackable.resourceable.display_type_name
        = 'to'
        = link_to activity.recipient.name, activity.recipient
    .activity_timestamp.subtext
      %i.fa.fa-clock-o
      = time_ago_in_words(activity.created_at)
      = 'ago'
    .activity__content
      - activities.each do |grouped_activity|
        - download_target = grouped_activity.trackable.resourceable.displayable_in_browser? ? '_blank' : '_top'
        .activity__resource-link
          - if YouTubeRails.extract_video_id grouped_activity.trackable.resourceable.url
            != YouTubeRails.youtube_embed_url grouped_activity.trackable.resourceable.url
          - else
            = link_to grouped_activity.trackable.resourceable.url, target: download_target do
              %i{class: "fa #{activity.trackable.resourceable.icon}"}
              = grouped_activity.trackable.resourceable.url_name
.activity__bottom
  - tags = activities.each_with_object([]) { |act, arr| act.recipient.base_tags.each { |tag| arr.push(tag) } }
  - if tags.present?
    %i.fa.fa-tags
    - uniq_tags = tags.uniq
    - uniq_tags.each_with_index do |tag, index|
      = link_to t("skill_names.#{tag.name}", default: tag.name), feats_path(filters: { tags: [tag.name] })
      = ', ' unless index == uniq_tags.count - 1
